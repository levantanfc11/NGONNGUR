setwd("C:/VANTAN")
Owls <- read.table(file="Owls.txt", header = TRUE) #d???c d??? li???u
names(Owls)
str(Owls)


#I. V??? bi???u d??? tuong quan gi???a (SiblingNegotiation)v???i(ArrivalTime) cho cùng 1 t??? (Nest)
Allnests = unique(Owls$Nest)
setwd("C:/VANTAN/anh") #???nh s??? du???c luu t???i noi này
N <- length(Allnests) #d??? dài c???a allnests
for (i in 1:N){ #ch???y t??? 1 cho d???n h???t d??? dài c???a allnest
  Nest.i = Allnests[i] #luu ??? v??? trí i vào nest.i
  Owls.i = Owls[Owls$Nest == Nest.i,]
  YourFileName = paste(Nest.i,".jpg",sep = "") #tên file luu
  jpeg(file = YourFileName)
  plot(x = Owls.i$ArrivalTime, y = Owls.i$NegPerChick, #t???o bi???n x và y
       xlab = "Arrival Time", #tên c???a c???t x
       main = Nest.i, # tên c???a tiêu d???
       ylab = "Negotiation behaviour" #tên c???a c???t y
  )
  dev.off()
}

#II.  D??? li???u v??? cú dã du???c l???y m???u trong hai dêm k??? lu???ng. N???u b???n ch???n d??? li???u t??? m???t t???, các quan sát s??? bao g???m c??? hai dêm. Hai dêm khác nhau v??? ch??? d??? cho an (no ho???c thi???u). D??? xem các quan sát trong m???t dêm, hãy ch???n t???t c??? các quan sát t??? m???t t??? và th???c an c??? th???. S??? d???ng các hàm ifesle và paste d??? t???o ra m???t giá tr??? phân lo???i m???i có th??? xác d???nh các quan sát t??? m???t dêm duy nh???t t???i m???t t??? c??? th???

Owls = read.table(file="Owls.txt",header=TRUE,dec = ".")# l???y d??? li???u v???
names(Owls)
str(Owls)
ifelse(Owls$FoodTreatment == "Satiated", Owls$NestNight <- paste(Owls$ï..Nest, "1",sep = "_"), Owls$NestNight <- paste(Owls$ï..Nest, "2",sep = "_"))
# N???u khi FoodTreatment là satiated thì paste vào c???t m???i vào là NestNight d??? li???u là c???t Nest và _1
# N???u khi FoodTreatment là satiated thì paste vào c???t m???i vào là NestNight d??? li???u là c???t Nest và _2
head(Owls)

AllNestsNights= unique(Owls$NestNight)
setwd("C:/VANTAN/anh") #???nh s??? du???c luu t???i noi này
N=length(AllNestsNights)# chi???u dài c???a AllNestNights
for (i in 1:N){
  NestNight.i = as.character(AllNestsNights[i]) # dua v??? d???ng character
  print(NestNight.i)
  Owlsi = Owls[Owls$NestNight == NestNight.i ,]
  YourFileName = paste(NestNight.i,".jpg",sep = "")# tên file luu
  jpeg(file = YourFileName)
  plot(x = Owlsi$ArrivalTime,y=Owlsi$NegPerChick,#t???o bi???n x và y
       xlab ="Arrival Time",#tên c???a c???t x
       ylab ="Sibling negotiation",# Tên c???a c???t y
       main = NestNight.i)# Tên tiêu d???
  dev.off()
}